<script src="../bower_components/page/page.js"></script>

<script>
  window.addEventListener('WebComponentsReady', () => {

    // Removes end / from app.baseUrl which page.base requires for production
    if (window.location.port === '') {  // if production
      page.base(app.baseUrl.replace(/\/$/, ''));
    }

    // Middleware
    let scrollToTop = (ctx, next) => {
      //app.scrollPageToTop();
      next();
    };

    let closeDrawer = (ctx, next) => {
      //app.closeDrawer();
      next();
    }

    let setFocus = (selected) => {
      //document.querySelector('section[data-route="' + selected + '"] .page-title').focus();
      console.log(document.querySelector('section[data-route="' + selected + '"]'));
    }

    // Routes
    page('*', scrollToTop, closeDrawer, (ctx, next) => {
      next();
    });

    page('/', () => {
      app.route = 'home';
      page.redirect('/home');
    });

    page('/home', () => {
      app.route = 'home';
    });

    page('/profile', () => {
      console.log("HOLA TEST");
      app.route = 'load1';
      console.log(document.querySelector('#zrickrApp'));
      setFocus(app.route);
    });

    page('/collections', () => {
      app.route = 'collections';
      page.redirect('/home');
    });

    page('/collections/:id', (data) => {
      app.route = 'collection';
      app.params = data.params;
    });

    // 404
    page('*', () => {
      /*app.$.toast.text = 'Can\'t find: ' + window.location.href  + '. Redirected you to Home Page';
      app.$.toast.show();
      console.log("error");
      page.redirect(app.baseUrl);*/
    });

    // add #! before urls
    page({
      hashbang: false
    });

  });
</script>
