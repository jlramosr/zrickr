<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-drawer-panel/paper-drawer-panel.html">
<link rel="import" href="../../bower_components/paper-scroll-header-panel/paper-scroll-header-panel.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../../elements/zrickr-drawer/zrickr-drawer.html">
<link rel="import" href="../../elements/zrickr-main/zrickr-main.html">
<link rel="import" href="../../elements/zrickr-collection/zrickr-collection.html">

<!--
`<zrickr-app>` provides a web main structure with a drawer
and a main content

Example:

    <zrickr-app></zrickr-app>

@element zrickr-app
@demo demo/index.html
-->

<dom-module id="zrickr-app">
  <style include="iron-flex iron-flex-alignment">
    #drawer {
      background: var(--drawer-background-color, --paper-grey-50);
    }
  </style>

  <template>
    <zrickr-collection
      id="collectionHandler"
      location="{{location}}"
      collections="{{collections}}">
    </zrickr-collection>
    <paper-drawer-panel id="mainPanel">
      <paper-scroll-header-panel id="drawer" drawer mode="cover">
        <zrickr-drawer collections="{{collections}}"><zrickr-drawer>
      </paper-scroll-header-panel>
      <paper-scroll-header-panel id="main" main condenses keep-condensed-header>
        <zrickr-main user={{user}}><zrickr-main>
      </paper-scroll-header-panel>
    </paper-drawer-panel>
  </template>
</dom-module>

<script>
(function() {
  Polymer({
    is: 'zrickr-app',

    properties: {
      positionDrawer: {
        type: String,
        value: 'left'
      },
      user: {
        type: Object,
      },
      collections: {
        type: Array,
        readonly: true
      }
    },

    listeners: {
      'add-item-tapped': '_newCollectionProcess',
      'add-item-finish': '_addCollection'
    },

    attached() {
      let mainPanel = this.$.mainPanel;
      if (this.positionDrawer == 'right') {
        mainPanel.rightDrawer = true;
      }
    },

    /**
     * Fired when the user taps on add a new item in drawer
     */
    _newCollectionProcess(event) {
      this.$.collectionHandler.new();
    },

    /**
     * Fires when the process of creation has finished
     */
    _addCollection(event) {
      let collection = event.detail;
      this.$.collectionHandler.add(collection);
    }

  });
})();
</script>
