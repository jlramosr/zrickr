<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/paper-radio-group/paper-radio-group.html">
<link rel="import" href="../../bower_components/paper-radio-button/paper-radio-button.html">
<link rel="import" href="../../bower_components/iron-image/iron-image.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="collection-header-dialog.html">

<dom-module id="collection-new-dialog">
  <template>
    <style include="iron-flex iron-flex-alignment">
      :host {
        --iron-icon-fill-color: var(--paper-amber-900);
      }

      paper-dialog {
        padding: 0 30px 10px 30px;
      }

      paper-radio-group {
        margin: 16px auto 16px auto;
      }

      paper-radio-group {
        font-size: 14px;
      }

      iron-image {
        height: 48px;
        width: 48px;
        background-repeat: no-repeat;
        background-position: 50%;
        border-radius: 50%;
        border: 1px solid var(--paper-amber-900);
        background-size: 100% auto;
      }

    </style>

    <paper-dialog modal id="dialog" class="layout vertical">
      <collection-header-dialog
        name="New Collection"
        description="Indicate how the collection will be created"
        current-step="1"
        number-steps="4">
      </collection-header-dialog>
      <paper-input
        label="Collection Name"
        value="{{collectionName}}"
        id="nameCollection"
        required
        pattern="^[A-Za-z0-9][A-Za-z0-9'\s-]*$"
        error-message="Only letters, number, spaces and dash are allowed"
        char-counter maxlength="20">
      </paper-input>
      <iron-image src="../../images/touch/apple-touch-icon.png"></iron-image>
      <paper-radio-group id="options" selected="{{selected}}" class="layout vertical">
        <paper-radio-button noink name="custom-check">
          <div class="layout horizontal center">
            <span>Custom Collection</span>
          </div>
        </paper-radio-button>
        <paper-radio-button noink name="users-check">
          <div class="layout horizontal center">
            <span>From other users</span>
          </div>
        </paper-radio-button>
      </paper-radio-group>
      <div class="buttons">
        <paper-button label="Cancel" dialog-dismiss>Cancel</paper-button>
        <paper-button label="Next" dialog-confirm>Next</paper-button>
      </div>
    </paper-dialog>

  </template>
</dom-module>

<script>
(function() {
  'use strict';

  Polymer({

    is: "collection-new-dialog",

    properties: {

      collectionName: {
        type: String,
      },

      selected: {
        type: String,
        value: 'custom-check',
      },

    },

    listeners: {
      'iron-overlay-closed': '_newCollectionDialogClosed',
    },

    ready() {
      this.$.nameCollection.errorMessage="";
      this.$.nameCollection.autoValidate=false;
    },

    _newCollectionDialogClosed(event) {
      if (event.detail.confirmed) {
        if (this.$.nameCollection.validate()) {
          console.log("VALID");
          let params = {};
          let itemSelected = this.$.options.selectedItem;
          params.optionSelected = itemSelected.name;
          this.fire('new-collection-dialog-next-tapped', params);
        }
        else {
          console.log("INVALID");
          event.stopPropagation();
          this.$.nameCollection.errorMessage="Error!!";
          this.$.nameCollection.autoValidate=true;
        }
      }
    },

    _validate() {

    },

    toggle() {
      this.$.dialog.toggle();
    },

  });
}());
</script>
